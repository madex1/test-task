var rus2eng={"А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"YO","Ж":"ZH","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"CH","Ш":"SH","Щ":"SHCH","Ъ":"","Ы":"Y","Ь":"","Э":"EH","Ю":"YU","Я":"YA","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"shch","ъ":"","ы":"y","ь":"","э":"eh","ю":"yu","я":"ya"};var eng2rus={"А":"A",YA:"Я"};var rus2engRE=/(?:[АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя])/g;var eng2rusRE=/(?:YA|A)/g;function trCallbackRu(a){return rus2eng[a]}function trCallbackEn(a){return eng2rus[a]}function transliterateRu(a){return a.replace(rus2engRE,trCallbackRu)}function transliterateEn(a){return a}function base64encode(g){var f="АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдежзийклмнопрстуфхцчшщъыьэюя";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var j=c.split("");var h=new Array();var b=0;for(b=0;b<g.length;b++){var d=g.charCodeAt(b);if(d>127){d=f.indexOf(g.charAt(b))+163;if(d<163){continue}}h.push(d)}var l=new Array();var e=h.length-h.length%3;var k=0;for(b=0;b<e;b+=3){k=(h[b]<<16)+(h[b+1]<<8)+h[b+2];l.push(j[(k>>18)&63]+j[(k>>12)&63]+j[(k>>6)&63]+j[k&63])}switch(h.length-e){case 1:k=h[e]<<4;l.push(j[(k>>6)&63]+j[k&63]+"==");break;case 2:k=(h[e]<<10)+(h[e+1]<<2);l.push(j[(k>>12)&63]+j[(k>>6)&63]+j[k&63]+"=");break}return l.join("")}var parsedCookies=null;function setCookie(b,c,a){var f="";if(a){var g=new Date();g.setTime(g.getTime()+a);f="; expires="+g.toGMTString()}if(c===null){f="; expires=Thu, 01-Jan-1970 00:00:01 GMT"}document.cookie=b+"="+c+f+"; path=/";if(parsedCookies){if(c!=null){parsedCookies[b]=c}else{delete parsedCookies[b]}}}function getCookie(a,c){if(typeof(c)=="undefined"){c=false}if(!parsedCookies||c){parsedCookies={};var d=document.cookie.split(";");for(var b=0;b<d.length;b++){var e=d[b].split("=");parsedCookies[e[0].replace(/^\s/,"")]=e[1]}}return parsedCookies[a]||null}function relationControl(r,b,j,h){var e=this;var d=r;var v=b||r;var q=true;var y=null;var B=null;var s=null;var f=null;var C=null;var a=null;var c=null;var A=null;var t=null;var m=0;var l=0;var z=h||"/admin/data/guide_items_all/";var w=function(){y=document.getElementById("relationSelect"+v);B=document.getElementById("relationInput"+v);s=document.getElementById("relationButton"+v);if(!y){alert("Select input for field #"+v+" not found");return}jQuery("option",y).each(function(){if(!this.selected&&this.value.length!==0){q=false}});if(s){s.onclick=function(){e.addObjectToGuide(null,null,function(F,G){e.addItem(F,G)})}}if(B){B.onkeyup=function(G){var F=G?G.keyCode:event.keyCode;if(F==13&&s){e.addItem();return false}else{e.doSearch()}};B.onkeydown=function(G){var F=G?G.keyCode:event.keyCode;if(F==13){return false}}}var E=function(){if(q){e.loadItemsAll();q=false}};y.onmouseover=E;y.onfocus=E;for(var D=0;D<y.childNodes.length;D++){if(y.childNodes[D].nodeType!=1){y.removeChild(y.childNodes[D]);D=0}}if(j&&jQuery("option[value='']",y).length==0){jQuery(y).prepend("<option value=''></option>")}};this.addObjectToGuide=function(K,J,M){var G=(typeof(B)==="object"?B.value:K);var L=(parseInt(d)>0?parseInt(d):parseInt(J));var F={url:"",data:null};var H={id:0,name:""};var I=document.getElementById("relationButton"+v);var E=null;var D=null;if(typeof(G)!=="string"||G.length<=0||L<=0){return}F.url="/admin/udata://data/addObjectToGuide/.json";F.data={param0:G,param1:L};I.setAttribute("disabled","");jQuery.ajax({url:F.url,dataType:"json",data:F.data,type:"post",success:function(N){if(typeof(N.data)!=="undefined"&&typeof(N.data.object)!=="undefined"){H.id=parseInt(N.data.object.id);if(isNaN(H.id)||H.id<=0){return}H.name=N.data.object.name;if(typeof(M)==="function"){M(H.name,H.id)}I.removeAttribute("disabled");if(C){E=jQuery("option:selected",y);D=jQuery("option:last",y);E=E.detach();jQuery(D).replaceWith(E)}}},error:function(){I.removeAttribute("disabled")}})};this.rescan=function(){B=document.getElementById("relationInput"+v);if(B){B.onkeyup=function(E){var D=E?E.keyCode:event.keyCode;if(D==13&&s){e.addItem()}else{e.doSearch()}}}};this.getValue=function(){var F=jQuery("option:selected",jQuery(y));var D={};for(var E=0;E<F.length;E++){D[F[E].value]=jQuery(F[E]).text()}return D};this.loadItems=function(D){jQuery.ajax({url:z+d+".xml?limit&search[]="+encodeURIComponent(D),type:"get",complete:function(F,E){e.updateItems(F)}})};this.loadItemsAll=function(){jQuery.ajax({url:z+d+".xml?allow-empty",type:"get",complete:function(E,D){e.updateItemsAll(E)}})};this.updateItemsAll=function(E){if(E.responseXML.getElementsByTagName("empty").length){if(B){B.onkeyup=function(P){var O=P?P.keyCode:event.keyCode;switch(O){case 38:if(A.length&&(t>0||t==null)){g((t===null)?(A.length-1):(t-1))}break;case 40:if(A.length&&(t<(A.length-1)||t==null)){g((t===null)?0:(t+1))}break;case 13:k();n();break;case 27:n();break;default:clearTimeout(c);c=setTimeout(function(){e.doSearchAjax()},500)}};B.onblur=function(){if(a){if(m<parseInt(a.style.left)||m>(parseInt(a.style.left)+parseInt(a.offsetWidth))||l<parseInt(a.style.top)||l>(parseInt(a.style.top)+parseInt(a.offsetHeight))){n()}}};var K=E.responseXML.getElementsByTagName("empty")[0].getAttribute("total");if(!C){C=new Option(" ","");C.innerHTML=getLabel("js-relation-total")+K+". "+getLabel("js-relation-use_search");y.insertBefore(C,y.firstChild)}}return}var I=E.responseXML.getElementsByTagName("object");var L=[];var F=0;for(F=0;F<y.options.length;F++){if(y.options[F].selected){L.push(y.options[F].value)}}jQuery("option",y).each(function(){if(!this.selected||this.value.length===0){jQuery(this).remove()}});if(j){$(y).prepend("<option value=''> </option>")}for(F=0;F<I.length;F++){var J=I[F].getAttribute("id");var G=false;for(var M in L){if(L[M]==J){G=true;delete L[M];break}}if(!G){var N=I[F].getAttribute("name");var D=new Option(N,J);D.innerHTML=N;y.appendChild(D)}}if(jQuery.browser.msie){var H=y.style.display;y.style.display="none";y.style.display=H}};this.updateItems=function(E){t=null;A=E.responseXML.getElementsByTagName("object");if(!A.length){return}var F=null;if(!a){a=document.createElement("div");a.className="relationAutosuggest";var H=jQuery(B).offset();a.style.position="absolute";a.style.zIndex=1050;a.style.width=B.clientWidth+"px";a.style.top=(H.top+B.offsetHeight)+"px";a.style.left=H.left+"px";F=document.createElement("ul");a.appendChild(F);document.body.appendChild(a)}a.style.display="";jQuery(document).mousemove(o);F=a.firstChild;while(F.firstChild){F.removeChild(F.firstChild)}for(i=0;i<A.length;i++){var G=A[i].getAttribute("name");var D=document.createElement("li");D.innerHTML=G;D.onmouseover=function(){g(this.suggestIndex)};D.onmouseout=function(){this.className=""};D.onclick=function(){k();n()};D.suggestIndex=i;F.appendChild(D)}};var o=function(D){if(!D){m=event.clientX+document.body.scrollLeft;l=event.clientY+document.body.scrollTop}else{m=D.pageX;l=D.pageY}return true};this.addItem=function(E,D){if(!(E&&E.length)&&!(B&&B.value.length)){return}x();u();if(!y.multiple&&f&&!E&&!D){f.innerHTML=(D?"":"&rarr;&nbsp;&nbsp;")+B.value;f.value=D?D:B.value;y.selectedIndex=0}else{f=new Option(E?E:B.value,D?D:B.value);f.innerHTML=(D?"":"&rarr;&nbsp;&nbsp;")+(E?E:B.value);if(y.options.length){y.insertBefore(f,y.firstChild)}else{y.appendChild(f)}}B.value="";f.selected=true;if(jQuery.browser.msie){setTimeout(function(){f.selected=false;f.selected=true},20)}};var g=function(E){if(a.style.display!="none"){var F=a.firstChild;var D=F.childNodes.item(t);if(D){D.className=""}F.childNodes.item(E).className="active";t=E}};var k=function(){if(a&&a.style.display!="none"&&t!==null){var G=A[t].getAttribute("name");var F=A[t].getAttribute("id");var E=false;for(var D=0;D<y.options.length;D++){if(y.options[D].value==F){E=true;y.options[D].selected=true;break}}if(!E){e.addItem(G,F)}}else{if(B.value.length&&s){e.addItem()}}};var n=function(){if(a&&a.style.display!="none"){a.style.display="none";jQuery(document).unbind("mousemove",o)}};this.doSearch=function(){var G=B.value.toLowerCase();x();if(G==""){if(y.multiple){u()}return}for(var E=0;E<y.options.length;E++){var H=y.options[E].text;var F=H.replace(/^.\s\s/,"");if(H.substring(0,G.length).toLowerCase()===G||F.substring(0,G.length).toLowerCase()===G){if(y.multiple){if(y.firstChild.nodeName.toLowerCase()!="optgroup"){p();searchGroup=y.firstChild;itemsGroup=y.lastChild}var D=y.options[E];if(D.parentNode==searchGroup){continue}D.oldPrevSibling=D.previousSibling;itemsGroup.removeChild(D);searchGroup.appendChild(D);if(searchGroup.childNodes.length==5){return}}else{y.selectedIndex=E;return}}}};this.doSearchAjax=function(){if(B.value){this.loadItems(B.value)}};var p=function(){var E=document.createElement("optgroup");E.label="Search results";var D=document.createElement("optgroup");D.label="------------------------------------------------";while(y.firstChild){var F=y.firstChild;y.removeChild(F);D.appendChild(F)}y.appendChild(E);y.appendChild(D)};var u=function(){if(y.firstChild&&y.firstChild.nodeName.toLowerCase()=="optgroup"){y.removeChild(y.firstChild);var D=y.firstChild;while(D.firstChild){var E=D.firstChild;D.removeChild(E);y.appendChild(E)}y.removeChild(D)}};var x=function(){if(y.firstChild&&y.firstChild.nodeName.toLowerCase()=="optgroup"){var E=y.firstChild;var D=y.lastChild;while(E.firstChild){var F=E.firstChild;E.removeChild(F);if(F.oldPrevSibling!==undefined||F.oldPrevSibling==null){if(F.oldPrevSibling&&F.oldPrevSibling.nextSibling){D.insertBefore(F,F.oldPrevSibling.nextSibling)}else{if(F.oldPrevSibling===null){D.insertBefore(F,D.firstChild)}else{D.appendChild(F)}}F.oldPrevSibling=undefined}}}};w()}function symlinkControl(C,n,K,N,M,j){M=(M instanceof Array)?M:[M];var h=this;var B=C;var I=(K instanceof Array)?K:[K];var d=(I)?"&hierarchy_types="+I.join("-"):"";var p=(M instanceof Array)?"&hierarchy_types="+M.join(","):"";var c=n||null;var y=null;var m=null;var A=null;var v=null;var P=null;var w=null;var H=null;var E=0;var D=0;if(!N){N={}}var O=N.iconsPath||"/images/cms/admin/mac/tree/";var G=N.fadeColorStart||[255,0,0];var s=N.fadeColorEnd||[255,255,255];var q=N.inputName||("symlinkInput"+B);var t=N.noImages||false;var e=N.treeURL||"/styles/common/js/tree.html";var F=N.rootId;var J=N.popupTitle||getLabel("js-cms-eip-symlink-choose-element");var o=typeof(N.showSuggestType)==="undefined"?true:N.showSuggestType;var b=typeof(N.cutSuggestNames)==="undefined"?true:N.cutSuggestNames;var a=parseInt(N.suggestDivWidth);var l={};var u=(j?"&callback=symlinkControlsList."+B+".onlyOne":"");var L=function(){if(!window.symlinkControlsList){window.symlinkControlsList={}}window.symlinkControlsList[B]=h;y=document.getElementById("symlinkInput"+B);if(!y){alert("Symlink container #"+B+" not found");return}var R=document.createElement("input");R.type="hidden";R.name=q;y.parentNode.insertBefore(R,y);v=document.createElement("ul");y.appendChild(v);var S=document.createElement("div");y.appendChild(S);m=document.createElement("input");m.setAttribute("placeholder",getLabel("js-cms-eip-symlink-search"));S.className="pick-element";S.appendChild(m);var T=18,U=28;m.style.width=S.parentNode.offsetWidth-(T+U)+"px";m.style.minWidth=S.parentNode.offsetWidth-(T+U)+"px";A=t?document.createElement("input"):document.createElement("img");S.appendChild(A);m.type="text";if(t){A.type="button";A.value="╘"}else{A.src="/images/cms/admin/mac/tree.png";A.height="18"}A.className="treeButton";A.onclick=function(){jQuery.openPopupLayer({name:"Sitetree",title:J,width:620,height:335,url:e+"?id="+B+(c?"&module="+c:"")+p+(window.lang_id?"&lang_id="+window.lang_id:"")+(F?"&root_id="+F:"")+u})};v.className="pageslist";m.onkeypress=function(W){var V=W?W.keyCode:window.event.keyCode;if(V==13){return false}};m.onkeyup=function(W){var V=W?W.keyCode:window.event.keyCode;switch(V){case 38:if(w.length&&(H>0||H==null)){r((H===null)?(w.length-1):(H-1))}break;case 40:if(w.length&&(H<(w.length-1)||H==null)){r((H===null)?0:(H+1))}break;case 13:x();Q();return false;break;case 27:Q();break;default:h.doSearch()}};m.onblur=function(){if(P){if(E<parseInt(P.style.left)||E>(parseInt(P.style.left)+parseInt(P.offsetWidth))||D<parseInt(P.style.top)||D>(parseInt(P.style.top)+parseInt(P.offsetHeight))){Q()}}}};this.loadItems=function(R){jQuery.ajax({url:"/admin/content/load_tree_node.xml?limit&domain_id[]="+(window.domain_id?window.domain_id:"1")+d+(window.lang_id?"&lang_id="+window.lang_id:"")+(F?"&rel="+F:"")+"&search-all-text[]="+encodeURIComponent(R),type:"get",complete:function(T,S){h.updateItems(T)}})};this.onlyOne=function(S,T,R,U){jQuery.closePopupLayer("Sitetree");if(confirm(getLabel("js-island-change-symlink-warning"))){jQuery("a.button",v).click();h.addItem(S,T,U,R);jQuery('form input[name="save-mode"]:first').click()}};this.updateItems=function(T){var U=(jQuery("html.u-eip").length>0);var R=null;H=null;R=T.responseXML.getElementsByTagName("page");if(!R.length){return}w=R;var V=[];for(var W=0;W<w.length;W++){if(l[w[W].getAttribute("id")]){continue}V[V.length]=w[W]}w=V;var X=null;if(!P){P=document.createElement("div");P.className="symlinkAutosuggest";var aa=jQuery(m).offset();P.style.position="absolute";P.style.zIndex=1100;P.style.width=m.clientWidth+"px";if(!isNaN(a)){P.style.width=a+"px"}P.style.top=(aa.top+m.offsetHeight)+"px";P.style.left=aa.left+"px";if(U){P.style.backgroundColor="white";P.style.border="1px solid #ccc"}X=document.createElement("ul");P.appendChild(X);document.body.appendChild(P)}z();jQuery(document).mousemove(g);X=P.firstChild;while(X.firstChild){X.removeChild(X.firstChild)}for(W=0;W<w.length;W++){if(l[w[W].getAttribute("id")]){continue}var S=k(w[W].getElementsByTagName("name")[0]);var Y=k(w[W].getElementsByTagName("basetype")[0]);var Z=w[W].getAttribute("link");var ad=document.createElement("li");var ac=document.createElement("span");var ab=document.createElement("a");ad.title=S;if(b){if(S.length>20){S=S.substr(0,20)+"..."}}if(Z.length>55){Z=Z.substr(0,55)+"..."}ad.appendChild(document.createTextNode(S));if(o){ad.appendChild(ac)}ac.appendChild(document.createTextNode(" ("+Y+")"));if(!U){ad.appendChild(document.createElement("br"));ad.appendChild(ab);ab.appendChild(document.createTextNode(Z));ab.href=Z;ab.target="_blank"}else{ac.style.display="block";ad.className="symlink-item-delete";ad.style.padding="3px"}ad.onmouseover=function(){r(this.suggestIndex)};ad.onclick=function(){x();Q()};ad.suggestIndex=W;X.appendChild(ad)}};this.doSearch=function(){var R=m.value;h.loadItems(R)};var r=function(T){var S=(jQuery("html.u-eip").length>0);if(P.style.display!="none"){var U=P.firstChild;var R=U.childNodes.item(H);if(R){if(S){R.style.backgroundColor=""}else{R.className=""}}if(S){U.childNodes.item(T).style.backgroundColor="#ceeaf6"}else{U.childNodes.item(T).className="active"}H=T}};var x=function(){if(P&&P.style.display!="none"&&H!==null){var X=w[H].getAttribute("id");var S=k(w[H].getElementsByTagName("name")[0]);var R=w[H].getAttribute("link");var V=w[H].getElementsByTagName("basetype")[0];var U="";var T=(U=V.getAttribute("module"))?U:"";var W=(U=V.getAttribute("method"))?U:"";h.addItem(X,S,[T,W],R)}};this.addItem=function(W,T,X,U){this.delPlaceHolder();if(l[W]!==undefined){return}var Y=(jQuery("html.u-eip").length>0);var Z=document.createElement("li");var ae=document.createElement("span");var ac=document.createElement("a");var V=document.createElement("a");var ad=document.createElement("input");var aa=this;ad.type="hidden";ad.name=q;ad.value=W;V.input=ad;ac.href=U;if(t){V.appendChild(document.createTextNode("[x]"))}else{var S=document.createElement("img");S.src=O+"symlink_delete.png";S.alt="delete";if(Y){S.className="symlink-item-delete"}V.appendChild(S)}V.href="javascript:void(0);";if(Y){V.style.marginRight="5px"}else{V.className="button"}V.onclick=function(){this.input.parentNode.removeChild(this.input);v.removeChild(this.parentNode);aa.addPlaceHolder();delete l[W]};ae.dataset.basetype=X[0]+" "+X[1];if(Y){ae.style.marginLeft="5px"}ae.appendChild(document.createTextNode(T));ac.appendChild(document.createTextNode(U));if(!t){var ab=document.createElement("img");ab.src=O+"ico_"+X[0]+"_"+X[1]+".png";Z.appendChild(ab)}Z.appendChild(ae);var af=32,R=38;ae.style.maxWidth=v.parentNode.offsetWidth-(af+R)+"px";Z.appendChild(V);if(Y){delete ac}else{Z.appendChild(ac)}v.appendChild(Z);y.parentNode.insertBefore(ad,y);Z.style.backgroundColor=makeHexRgb(G);Z.startColor=G;Z.endColor=s;Z.pname=T;Z.fade=f;setTimeout(function(){Z.fade()},2000);l[W]=true;if(jQuery("#eip_page").length){frameElement.height=(jQuery("#eip_page").height()>500)?500:jQuery("#eip_page").height()}};this.delPlaceHolder=function(){if(jQuery(".eip-placeholder",v).length>=1){jQuery(".eip-placeholder",v).remove()}};this.addPlaceHolder=function(U){var R=document.createElement("li"),T=U||getLabel("js-cms-eip-symlink-no-elements"),S="eip-placeholder";R.className=S;R.appendChild(document.createTextNode(T));if(jQuery("li",v).length<1){v.appendChild(R)}};var f=function(){if(this.fadeColor==undefined){this.fadeColor=[];this.fadeColor[0]=this.startColor[0];this.fadeColor[1]=this.startColor[1];this.fadeColor[2]=this.startColor[2]}if(Math.round(this.fadeColor[0]+this.fadeColor[1]+this.fadeColor[2])==Math.round(this.endColor[0]+this.endColor[1]+this.endColor[2])){return}this.fadeColor[0]+=(this.endColor[0]-this.startColor[0])/50;this.fadeColor[1]+=(this.endColor[1]-this.startColor[1])/50;this.fadeColor[2]+=(this.endColor[2]-this.startColor[2])/50;this.style.backgroundColor=makeHexRgb(this.fadeColor);var R=this;setTimeout(function(){R.fade()},20)};var z=function(){if(P){var R=jQuery(m).offset();P.style.width=m.clientWidth;P.style.top=R.top+m.offsetHeight;P.style.left=R.left;P.style.display=""}};var Q=function(){if(P&&P.style.display!="none"){P.style.display="none";jQuery(document).unbind("mousemove",g)}};var g=function(R){if(!R){E=event.clientX+document.body.scrollLeft;D=event.clientY+document.body.scrollTop}else{E=R.pageX;D=R.pageY}return true};var k=function(R){return(R.firstChild&&R.firstChild.nodeType==3)?R.firstChild.nodeValue:R.nodeValue};L()}var hex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function makeHexRgb(b){var a="";for(var c=0;c<3;c++){a=a+hex[Math.floor(b[c]/16)]+hex[Math.floor(b[c]%16)]}return"#"+a}function changeParentControl(f,t,y,p,e){var h=this;var x=f;var p=(p instanceof Array)?p:[p];var F=(p instanceof Array)?"&hierarchy_types="+p.join(","):"";var d=t||null;var u=null;var I=null;var g=null;var a=null;var b=null;var G=null;var z=null;var q=0;var n=0;if(!y){var y={}}var w=y.iconsPath||"/images/cms/admin/mac/tree/";var C=y.fadeColorStart||[255,0,0];var H=y.fadeColorEnd||[255,255,255];var o=y.inputName||("changeParentInput"+x);var B=y.noImages||false;var k={};var s=e;var E=e?"":'&callback=changeParentControlsList["'+x+'"].moveItem';var D=function(){if(!window.changeParentControlsList){window.changeParentControlsList={}}window.changeParentControlsList[x]=h;u=document.getElementById("changeParentInput"+x);if(!u){alert("Change parent container #"+x+" not found");return}var J=document.createElement("input");J.type="hidden";J.name=o;u.parentNode.insertBefore(J,u);a=document.createElement("ul");u.appendChild(a);I=document.createElement("input");u.appendChild(I);g=B?document.createElement("input"):document.createElement("img");u.appendChild(g);I.type="text";if(B){g.type="button";g.value="?"}else{g.src="/images/cms/admin/mac/tree.png";g.height="18"}g.className="treeButton";g.onclick=function(){jQuery.openPopupLayer({name:"Sitetree",title:getLabel("js-cms-eip-symlink-choose-element"),width:620,height:335,url:"/styles/common/js/parents.html?id="+x+(d?"&module="+d:"")+F+(window.lang_id?"&lang_id="+window.lang_id:"")+E})};a.className="pageslist";I.onkeypress=function(L){var K=L?L.keyCode:window.event.keyCode;if(K==13){return false}};I.onkeyup=function(L){var K=L?L.keyCode:window.event.keyCode;switch(K){case 38:if(G.length&&(z>0||z==null)){j((z===null)?(G.length-1):(z-1))}break;case 40:if(G.length&&(z<(G.length-1)||z==null)){j((z===null)?0:(z+1))}break;case 13:m();r();return false;break;case 27:r();break;default:h.doSearch()}};I.onblur=function(){if(b){if(q<parseInt(b.style.left)||q>(parseInt(b.style.left)+parseInt(b.offsetWidth))||n<parseInt(b.style.top)||n>(parseInt(b.style.top)+parseInt(b.offsetHeight))){r()}}}};this.loadSuggestItems=function(J){jQuery.ajax({url:"/admin/content/load_tree_node.xml?limit&domain_id[]="+(window.domain_id?window.domain_id:"1")+F+(window.lang_id?"&lang_id="+window.lang_id:"")+"&search-all-text[]="+encodeURIComponent(J),type:"get",complete:function(L,K){h.updateSuggestItems(L)}})};this.updateSuggestItems=function(K){z=null;G=K.responseXML.getElementsByTagName("page");if(!G.length){return}var L=[];for(var M=0;M<G.length;M++){if(k[G[M].getAttribute("id")]){continue}L[L.length]=G[M]}G=L;var N=null;if(!b){b=document.createElement("div");b.className="symlinkAutosuggest";var P=jQuery(I).offset();b.style.position="absolute";b.style.zIndex=1050;b.style.width=I.clientWidth+"px";b.style.top=(P.top+I.offsetHeight)+"px";b.style.left=P.left+"px";N=document.createElement("ul");b.appendChild(N);document.body.appendChild(b)}l();jQuery(document).mousemove(v);N=b.firstChild;while(N.firstChild){N.removeChild(N.firstChild)}for(M=0;M<G.length;M++){if(k[G[M].getAttribute("id")]){continue}var J=c(G[M].getElementsByTagName("name")[0]);var O=c(G[M].getElementsByTagName("basetype")[0]);var Q=G[M].getAttribute("link");var T=document.createElement("li");var S=document.createElement("span");var R=document.createElement("a");T.title=J;if(J.length>20){J=J.substr(0,20)+"..."}T.appendChild(document.createTextNode(J));T.appendChild(S);T.appendChild(document.createElement("br"));T.appendChild(R);S.appendChild(document.createTextNode(" ("+O+")"));R.href=Q;R.target="_blank";if(Q.length>170){Q=Q.substr(0,170)+"..."}R.appendChild(document.createTextNode(Q));T.onmouseover=function(){j(this.suggestIndex)};T.onclick=function(){m();r()};T.suggestIndex=M;N.appendChild(T)}};this.doSearch=function(){var J=I.value;h.loadSuggestItems(J)};var j=function(K){if(b.style.display!="none"){var L=b.firstChild;var J=L.childNodes.item(z);if(J){J.className=""}L.childNodes.item(K).className="active";z=K}};var m=function(){if(b&&b.style.display!="none"&&z!==null){var J=G[z].getAttribute("id");if(s){h.addItem(J)}else{h.moveItem(J)}}};this.addItem=function(J){jQuery.ajax({url:"/admin/content/tree_copy_element.json",type:"get",dataType:"json",data:{element:window.page_id,rel:J,copyAll:1,return_copies:1,clone_mode:0},success:function(K){pageCopy=K.data.page.copies.copy[0];linkText=document.createElement("span");for(i in pageCopy.parents.item){parentItem=pageCopy.parents.item[i];var L=document.createElement("a");L.href="/admin/"+parentItem.module+"/"+parentItem.method+"/";L.target="_blank";L.className="tree_link";L.onclick=function(){return treeLink(parentItem.settingsKey,parentItem.treeLink)};L.title=parentItem.url;L.appendChild(document.createTextNode(parentItem.name));linkText.appendChild(L);linkText.appendChild(document.createTextNode(" / "))}var L=document.createElement("a");L.href=pageCopy["edit-link"];L.title=pageCopy.url;L.appendChild(document.createTextNode(pageCopy.name));linkText.appendChild(L);h.loadItem(pageCopy.id,linkText,pageCopy.basetype)}})};this.moveItem=function(J){if(window.page_id==J){return false}jQuery.ajax({url:"/admin/content/tree_move_element.json",type:"get",dataType:"json",data:{element:window.page_id,rel:J,return_copies:1},success:function(K){pageCopy=K.data.page.copies.copy[0];linkText=document.createElement("span");for(i in pageCopy.parents.item){parentItem=pageCopy.parents.item[i];var L=document.createElement("a");L.href="/admin/"+parentItem.module+"/"+parentItem.method+"/";L.target="_blank";L.className="tree_link";L.onclick=function(){return treeLink(parentItem.settingsKey,parentItem.treeLink)};L.title=parentItem.url;L.appendChild(document.createTextNode(parentItem.name));linkText.appendChild(L);linkText.appendChild(document.createTextNode(" / "))}var L=document.createElement("span");L.title=pageCopy.url;L.appendChild(document.createTextNode(pageCopy.name));linkText.appendChild(L);h.loadItem(pageCopy.id,linkText,pageCopy.basetype)}})};this.loadItem=function(M,O,N){if((k[M]!==undefined)&&s){return}var P=document.createElement("li");if(s){var K=document.createElement("a");if(B){K.appendChild(document.createTextNode("[x]"))}else{var J=document.createElement("img");J.src=w+"symlink_delete.png";J.alt="delete";K.appendChild(J)}K.href="javascript:void(0);";K.className="button";K.onclick=function(){jQuery.ajax({url:"/admin/content/tree_delete_element.xml",type:"get",dataType:"xml",data:{element:M,childs:1,allow:true},context:this,success:function(){a.removeChild(this.parentNode);delete k[M]}})};P.appendChild(K)}if(!B){var R=document.createElement("img");R.src=w+"ico_"+N.module+"_"+N.method+".png";P.appendChild(R)}var L=O.innerText||O.textContent;if(L.length>170){newTitle=O.innerText;lastChildText=O.lastChild.innerText||O.lastChild.textContent;if(lastChildText.length>100){lastChildText=lastChildText.substr(0,96)+"...";if(O.lastChild.innerText){O.lastChild.innerText=lastChildText}else{O.lastChild.textContent=lastChildText}L=O.innerText||O.textContent}if(L.length>170){while(L.length>170&&O.childNodes.length>3){dropLink=parseInt(O.childNodes.length/2);dropLink=dropLink-(dropLink%2);O.removeChild(O.childNodes[dropLink]);O.removeChild(O.childNodes[(dropLink-1)]);L=O.innerText||O.textContent}var Q=document.createElement("span");Q.title=newTitle;if(L.length<=170){dropLink=parseInt(O.childNodes.length/2);dropLink=dropLink-(1-dropLink%2);Q.appendChild(document.createTextNode(" / ... /"))}else{O.removeChild(O.childNodes[0]);dropLink=0;Q.appendChild(document.createTextNode("... /"))}O.replaceChild(Q,O.childNodes[dropLink])}}P.appendChild(O);if(!s&&a.lastChild){a.removeChild(a.lastChild)}a.appendChild(P);P.style.backgroundColor=makeHexRgb(C);P.startColor=C;P.endColor=H;P.pname=O;P.fade=A;setTimeout(function(){P.fade()},2000);k[M]=true;if(jQuery("#eip_page").length){frameElement.height=(jQuery("#eip_page").height()>500)?500:jQuery("#eip_page").height()}};var A=function(){if(this.fadeColor==undefined){this.fadeColor=[this.startColor[0],this.startColor[1],this.startColor[2]]}if(Math.round(this.fadeColor[0]+this.fadeColor[1]+this.fadeColor[2])==Math.round(this.endColor[0]+this.endColor[1]+this.endColor[2])){return}this.fadeColor[0]+=(this.endColor[0]-this.startColor[0])/50;this.fadeColor[1]+=(this.endColor[1]-this.startColor[1])/50;this.fadeColor[2]+=(this.endColor[2]-this.startColor[2])/50;this.style.backgroundColor=makeHexRgb(this.fadeColor);var J=this;setTimeout(function(){J.fade()},20)};var l=function(){if(b){var J=jQuery(I).offset();b.style.width=I.clientWidth;b.style.top=J.top+I.offsetHeight;b.style.left=J.left;b.style.display=""}};var r=function(){if(b&&b.style.display!="none"){b.style.display="none";jQuery(document).unbind("mousemove",v)}};var v=function(J){if(!J){q=event.clientX+document.body.scrollLeft;n=event.clientY+document.body.scrollTop}else{q=J.pageX;n=J.pageY}return true};var c=function(J){return(J.firstChild&&J.firstChild.nodeType==3)?J.firstChild.nodeValue:J.nodeValue};D()}function permissionsControl(a){var e=this;var o=document.getElementById(a);var u=null;var n=null;var g={};var w=0;var q=null;var b=null;var v=null;var s=null;var l=0;var k=0;var x=[getLabel("js-permissions-view"),getLabel("js-permissions-edit"),getLabel("js-permissions-create"),getLabel("js-permissions-delete"),getLabel("js-permissions-move")];var r=function(){var H=document.createElement("table");var C=document.createElement("tr");var z=document.createElement("th");z.style.width="100%";z.appendChild(document.createTextNode(" "));C.appendChild(z);var E=["/images/cms/admin/mac/tree/view.png","/images/cms/admin/mac/tree/ico_edit.png","/images/cms/admin/mac/tree/ico_add.png","/images/cms/admin/mac/tree/ico_del.png","/images/cms/admin/mac/ico_data_drag_a.gif"];for(var A=0;A<x.length;A++){z=document.createElement("th");var B=document.createElement("img");B.src=E[A];B.alt=B.title=x[A];z.appendChild(B);z.className="permissionType";C.appendChild(z)}H.className="permissionTable";var y=document.createElement("tr");var G=document.createElement("td");G.colspan=6;G.setAttribute("colspan","6");G.className="addOwner";y.appendChild(G);n=document.createElement("input");G.appendChild(n);n.onkeypress=function(J){var I=J?J.keyCode:window.event.keyCode;if(I==13){return false}};n.onkeyup=t;n.onblur=d;u=document.createElement("tbody");var D=document.createElement("thead");D.appendChild(C);var F=document.createElement("tfoot");F.appendChild(y);H.appendChild(D);H.appendChild(u);H.appendChild(F);o.appendChild(H);e.add("system-guest","",0)};this.add=function(A,z,y,G){var E={};E.id=A;E.name=z;E.level=y;if(A=="system-guest"){w=y;z=getLabel("js-all")}else{if(y==w&&!G){return}}if(A=="system-supervisor"||A=="users-users-15"){return}g[A]=E;var J=document.createElement("tr");var F=document.createElement("td");var I=document.createElement("img");I.src="/images/cms/admin/mac/perm_user.png";F.appendChild(document.createTextNode(z));J.appendChild(F);var D=[1,2,4,8,16];var B=["perms_read","perms_edit","perms_create","perms_delete","perms_move"];for(var H=0;H<D.length;H++){var C=document.createElement("input");C.type="checkbox";C.name=B[H]+"["+A+"]";C.value=D[H];C.title=x[H];F=document.createElement("td");F.appendChild(C);F.className="permissionType";J.appendChild(F);if(y&D[H]){C.checked=true}}if(A=="system-guest"&&q){u.replaceChild(J,q)}else{u.appendChild(J)}if(A=="system-guest"){q=J}};this.loadItems=function(y){jQuery.ajax({url:"/admin/users/getPermissionsOwners/4.xml?limit&search-all-text[]="+encodeURIComponent(y),method:"get",complete:function(z){e.updateItems(z)}})};this.updateItems=function(A){s=null;v=A.responseXML.getElementsByTagName("owner");var C=[];if(!v.length){return}for(var D=0;D<v.length;D++){var z=parseInt(v[D].getAttribute("id"));if(g[z]==undefined){C[C.length]=v[D]}}v=C;if(!v.length){return}var F=null;if(!b){b=document.createElement("div");b.className="symlinkAutosuggest";var H=jQuery(n).offset();b.style.position="absolute";b.style.zIndex=1050;b.style.width=n.clientWidth+"px";b.style.top=(H.top+n.offsetHeight)+"px";b.style.left=H.left+"px";F=document.createElement("ul");b.appendChild(F);document.body.appendChild(b)}h();jQuery(document).mousemove(p);F=b.firstChild;while(F.firstChild){F.removeChild(F.firstChild)}var E=0;for(D=0;D<v.length;D++){var K=v[D].getAttribute("name");var J=document.createElement("li");var G=document.createElement("img");G.src="/images/cms/admin/mac/perm_"+v[D].getAttribute("type")+".png";J.appendChild(G);J.appendChild(document.createTextNode(K));if(v[D].getAttribute("type")=="group"){J.appendChild(document.createElement("br"));var I=document.createElement("span");J.appendChild(I);var y=v[D].getElementsByTagName("user");var L="";for(var B=0;B<y.length;B++){L=L+(B?", ":"")+y[B].getAttribute("name")}I.appendChild(document.createTextNode(L))}J.onmouseover=function(){f(this.suggestIndex)};J.onmouseout=function(){this.className=""};J.onclick=function(){j();m();n.value=""};J.suggestIndex=E;F.appendChild(J);E++}};this.doSearch=function(){var y=n.value;e.loadItems(y)};var f=function(z){if(b.style.display!="none"){var A=b.firstChild;var y=A.childNodes.item(s);if(y){y.className=""}A.childNodes.item(z).className="active";s=z}};var j=function(){if(b&&b.style.display!="none"&&s!==null){var A=v[s].getAttribute("id");var y=v[s].getAttribute("name");var z=v[s].getAttribute("type");if(z!="user"){e.add(A,y,w,true)}else{jQuery.ajax({url:"/udata/users/getUserPermissions/"+A+"/"+window.page_id+"/",method:"get",complete:function(C){var B=C.responseXML.getElementsByTagName("user");var D=w;if(B.length){D=parseInt(jQuery(B[0]).text())}e.add(A,y,D,true)}})}}};var d=function(){if(b){if(l<parseInt(b.style.left)||l>(parseInt(b.style.left)+parseInt(b.offsetWidth))||k<parseInt(b.style.top)||k>(parseInt(b.style.top)+parseInt(b.offsetHeight))){m()}}};var t=function(z){var y=z?z.keyCode:window.event.keyCode;switch(y){case 38:if(v.length&&(s>0||s==null)){f((s===null)?(v.length-1):(s-1))}break;case 40:if(v.length&&(s<(v.length-1)||s==null)){f((s===null)?0:(s+1))}break;case 13:j();m();return false;break;case 27:m();break;default:e.doSearch()}};var h=function(){if(b){var y=jQuery(n).offset();b.style.width=n.clientWidth;b.style.top=y.top+n.offsetHeight;b.style.left=y.left;b.style.display=""}};var m=function(){if(b&&b.style.display!="none"){b.style.display="none";jQuery(document).unbind("mousemove",p)}};var p=function(y){if(!y){l=event.clientX+document.body.scrollLeft;k=event.clientY+document.body.scrollTop}else{l=y.pageX;k=y.pageY}return true};var c=function(y){return(y.firstChild&&y.firstChild.nodeType==3)?y.firstChild.nodeValue:y.nodeValue};r()}function fileControl(name,options){var _self=this;var container=document.getElementById("fileControlContainer_"+name);var select=null;var inputName=options.inputName||name;var imagesOnly=options.imagesOnly||false;var videosOnly=options.videosOnly||false;var folderHash=options.folderHash;var fileHash=options.fileHash;var lang=options.lang||"ru";var fm=options.fm||"flash";var cwd=".";var defaultCwd=".";var loaded=false;var construct=function(){select=document.createElement("select");container.appendChild(select);select.onmouseover=function(){if(!loaded){loadListing()}};window["fileControlSelect_"+name]=select;select.id="fileControlSelect_"+name;select.name=inputName;select.control=_self;select.className="fileControlSelect";if((navigator.userAgent.toLowerCase().indexOf("firefox")!=-1)||(navigator.userAgent.toLowerCase().indexOf("chrome")!=-1)){select.addEventListener("drop",doDrop,false);select.addEventListener("dragexit",dragExit,false);select.addEventListener("dragover",dragExit,false);jQuery(select).addClass("dragNDrop")}var option=document.createElement("option");option.innerHTML="";option.value="";option.selected=true;select.appendChild(option);var img=document.createElement("img");img.src="/images/cms/browse_folder.png";var a=document.createElement("a");a.href="javascript:void(0);";a.onclick=function(){var functionName="show"+fm+"FileBrowser";eval(functionName+"(select.id, defaultCwd, imagesOnly, videosOnly, folderHash, fileHash, lang)")};a.appendChild(img);container.appendChild(a)};function doDrop(event){dragExit(event);var dt=event.dataTransfer;var files=dt.files;var file=files[0];jQuery.ajax({url:"/admin/data/uploadfile/?filename="+file.name+"&folder="+base64encode(cwd.substr(1))+(imagesOnly?"&showOnlyImages=1":"")+(videosOnly?"&showOnlyVideos=1":""),type:"POST",processData:false,data:file,complete:function(r,t){_self.updateItem(r)}})}function dragExit(event){event.stopPropagation();event.preventDefault()}var showflashFileBrowser=function(selectId,folder,imageOnly,videoOnly,folder_hash,file_hash,lang){var qs="id="+selectId;var index=0;var file=cwd.replace(/^\.\//,"/")+((index=select.value.lastIndexOf("/"))!=-1?select.value.substr(index):select.value);qs=qs+"&file="+file;if(folder){qs=qs+"&folder="+folder}if(imageOnly){qs=qs+"&image=1"}if(videoOnly){qs=qs+"&video=1"}jQuery.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:1200,height:600,url:"/styles/common/other/filebrowser/umifilebrowser.html?"+qs})};var showelfinderFileBrowser=function(selectId,folder,imageOnly,videoOnly,folder_hash,file_hash,lang){var qs="id="+selectId;var index=0;var file=cwd.replace(/^\.\//,"/")+((index=select.value.lastIndexOf("/"))!=-1?select.value.substr(index):select.value);qs=qs+"&file="+file;if(folder){qs=qs+"&folder="+folder}if(imageOnly){qs=qs+"&image=1"}if(videoOnly){qs=qs+"&video=1"}if(typeof(folder_hash)!="undefined"){qs=qs+"&folder_hash="+folder_hash}if(typeof(file_hash)!="undefined"){qs=qs+"&file_hash="+file_hash}if(lang){qs=qs+"&lang="+lang}$.openPopupLayer({name:"Filemanager",title:getLabel("js-file-manager"),width:1200,height:600,url:"/styles/common/other/elfinder/umifilebrowser.html?"+qs});var filemanager=jQuery("div#popupLayer_Filemanager div.popupBody");if(!filemanager.length){filemanager=jQuery(window.parent.document.getElementById("popupLayer_Filemanager")).find("div.popupBody")}var options='<div id="watermark_wrapper"><label for="add_watermark">';options+=getLabel("js-water-mark");options+='</label><input type="checkbox" name="add_watermark" id="add_watermark"/>';options+='<label for="remember_last_folder">';options+=getLabel("js-remember-last-dir");options+='</label><input type="checkbox" name="remember_last_folder" id="remember_last_folder"';if(getCookie("remember_last_folder",true)){options+='checked="checked"'}options+="/></div>";filemanager.append(options)};this.clearItems=function(){while(select.options.length){select.options[0].parentNode.removeChild(select.options[0])}var option=document.createElement("option");option.innerHTML="";option.value=cwd+"/";option.selected=true;select.appendChild(option);loaded=false};var loadListing=function(){loaded=true;jQuery.ajax({url:"/admin/data/getfilelist/?folder="+base64encode(cwd.substr(1))+(imagesOnly?"&showOnlyImages=1":"")+(videosOnly?"&showOnlyVideos=1":""),type:"get",complete:function(r,t){_self.updateItems(r)}})};this.updateItems=function(response){if(!response.responseXML.getElementsByTagName("empty").length){var files=response.responseXML.getElementsByTagName("file");if(!select.options.length){this.add(null,true)}for(var i=0;i<files.length;i++){this.add(files[i].getAttribute("name"))}if(jQuery.browser.msie){var d=select.style.display;select.style.display="none";select.style.display=d}}else{var option=document.createElement("option");option.value="";option.disabled="disable";option.appendChild(document.createTextNode(getLabel("js-files-use_search")));select.appendChild(option)}};this.setFolder=function(name,isDefault){if(name.indexOf("./")!==0){name="."+name}var re=new RegExp("[/]+$","g");name=(name+"").replace(re,"");if(cwd!=name){cwd=name;this.clearItems()}if(isDefault!=undefined&&isDefault){defaultCwd=name}};this.add=function(name,selected){if(name&&!name.length){return}if(!name){name=""}if(name.lastIndexOf("/")!=-1){this.setFolder(name.substr(0,name.lastIndexOf("/")));name=name.substr(name.lastIndexOf("/")+1)}for(var i=0;i<select.options.length;i++){if(select.options[i].innerHTML==name){if(selected){select.options[i].selected=selected}return}}var option=document.createElement("option");option.innerHTML=name;option.value=((cwd.indexOf("./")!=0)?".":"")+(cwd+"/"+name);if(selected!=undefined&&selected){option.selected=true}select.appendChild(option)};this.updateItem=function(response){var files=response.responseXML.getElementsByTagName("file");if(!select.options.length){this.add(null,true)}for(var i=0;i<files.length;i++){this.add(files[i].getAttribute("name"),true)}if(jQuery.browser.msie){var d=select.style.display;select.style.display="none";select.style.display=d}};construct()}(function(){var a=function(){jQuery.get("/umess/inbox/?mark-as-opened=1",function(b){jQuery("message",b).each(function(d,g){var h=jQuery(g).attr("title");var f=jQuery("content",g).text();var c=jQuery("date",g).text();var e=jQuery("sender",g).attr("name");f="<p>"+f+'</p><div class="header">'+c+", "+e+"</div>";jQuery.jGrowl(f,{header:h,life:10000})})});setTimeout(a,15000)}})();var askSupport=function(){var a='<h3 id="license_message">'+getLabel("js-now-we-will-check-your-domain-key")+"</h3>";a+='<div id="ask_support_form">';a+='<div id="loading"></div>';a+='<span id="show_info" style="">'+getLabel("js-info")+"</span>";a+='<div id="info_support">';a+='<div class="left"><h4>'+getLabel("js-when-creating-request-remember")+"</h4>";a+="<ul>";a+="<li>"+getLabel("js-i-hate-multiple-questions")+"</li>";a+="<li>"+getLabel("js-i-want-postpone")+"</li>";a+="<li>"+getLabel("js-i-hate-doubles")+"</li>";a+="<li>"+getLabel("js-no-demo")+"</li>";a+="</ul></div>";a+='<div class="right"><h4>'+getLabel("js-i-decline-support")+"</h4>";a+="<ul>";a+="<li>"+getLabel("js-if-somebody-do-something-perverted")+"</li>";a+="<li>"+getLabel("js-if-you-have-not-read-manual")+"</li>";a+="<li>"+getLabel("js-if-mysql-has-gone-away")+"</li>";a+="</ul></div>";a+='<div class="clear" />';a+="</div>";a+='<div id="form_body"></div>';a+="</div>";a+='<div class="eip_buttons">';a+='<input id="checkLicenseKey" type="button" value="'+getLabel("js-send")+'" class="ok" style="display:none;"/>';a+='<input id="stop_btn" type="button" value="'+getLabel("js-close")+'" class="stop" />';a+='<div style="clear: both;"/>';a+="</div>";openDialog({stdButtons:false,title:getLabel("js-ask-support"),text:a,width:637,OKCallback:function(){}});$("#stop_btn").one("click",function(){closeDialog()});jQuery(document).ajaxStart(function(){jQuery("#loading").html('<img src="/images/cms/admin/mac/ajax_loader.gif" alt="Loading..." />')});jQuery.ajax({type:"POST",url:"/udata/system/checkLicenseKey/",dataType:"xml",success:function(k){jQuery("#form_body").html("");jQuery("#loading").html("");var n="";var j=k.getElementsByTagName("error");if(j.length){n=j[0].firstChild.nodeValue}var g=k.getElementsByTagName("notes");if(g.length){n+=g[0].firstChild.nodeValue}jQuery("#license_message").html(n);var b=k.getElementsByTagName("form");if(b.length){var d=k.getElementsByTagName("user");jQuery("#form_body").html('<form id="support_request" action="" method="post">'+b[0].firstChild.nodeValue+"</form>");jQuery('input[name="data[fio_frm]"]').val(d[0].getAttribute("name"));jQuery("#email_frm").val(d[0].getAttribute("email"));var l=jQuery('input[name="data[cms_domain]"]').parent();jQuery('input[name="data[cms_domain]"]').remove();var h=document.createElement("select");h.name="data[cms_domain]";var m=k.getElementsByTagName("domains");for(var e=0;e<m[0].getElementsByTagName("domain").length;e++){var c=m[0].getElementsByTagName("domain");c=c[e];var f=document.createElement("option");f.value=c.getAttribute("host");if(c.getAttribute("host")==d[0].getAttribute("domain")){f.selected=true}f.appendChild(document.createTextNode(c.getAttribute("host")));h.appendChild(f)}l.append(h);jQuery("#attach_file").parent("div").remove();jQuery(".button_1").remove();jQuery("#checkLicenseKey").attr("style","");jQuery("#show_info").attr("style","display:inline-block;");jQuery("#show_info").click(function(){jQuery("#info_support").toggle("slow")});jQuery.centerPopupLayer();jQuery("#checkLicenseKey").bind("click",function(){jQuery.ajax({type:"POST",url:"/udata/system/sendSupportRequest/",data:jQuery("#support_request").serializeArray(),success:function(p){jQuery("#loading").html("");var o=p.getElementsByTagName("error");if(o.length){n='<span style="color:red;">'+o[0].firstChild.nodeValue+"</span>"}var q=p.getElementsByTagName("success");if(q.length){n=q[0].firstChild.nodeValue;jQuery("#ask_support_form").remove();jQuery("#checkLicenseKey").remove()}jQuery("#license_message").html(n);jQuery.centerPopupLayer()}});return false})}return},error:function(b,d,c){if(window.session){window.session.stopAutoActions()}}})};function colorControl(c,b){var b=b||{};var e={colorBox:'<span class="color-box"><i></i></span>',container:c,assets:{js:"/js/jquery/colorpicker/js/bootstrap-colorpicker.js",jsMin:"/js/jquery/colorpicker/js/bootstrap-colorpicker.min.js",css:"/js/jquery/colorpicker/css/bootstrap-colorpicker.min.css"}};var a={options:{defaultValues:{component:".color-box",customClass:"color-picker"},user:b.pickerOptions||{}}};jQuery.extend(a.options.user,a.options.defaultValues);jQuery.extend(b,e);jQuery(b.colorBox).insertAfter(jQuery("input",c));if(typeof jQuery.colorpicker!=="function"){if(b.debug){d(b.assets.js,b.assets.css)}else{d(b.assets.jsMin,b.assets.css)}}jQuery(b.container).colorpicker(a.options.user);function d(g,f){jQuery('<script src="'+g+'" type="text/javascript" charset="utf-8"><\/script>').appendTo("head");jQuery('<link href="'+f+'" rel="stylesheet" charset="utf-8"><\/script>').appendTo("head")}};